# 1. MySQL基础

`MySQL`采用客户端/服务器架构，用户通过客户端程序发送增删改查请求，服务器程序收到请求后处理，并把处理结果返回给客户端

## 1.1 启动程序

bin目录下存放了服务器和客户端的可执行文件

1. 启动服务器程序

   ```bash
   mysqld		# 该文件表示MySQL服务器程序，运行它可直接启动MySQL服务器进程
   ```

   ```bash
   mysqld_safe		# 启动脚本，间接调用mysqld
   mysql.server start	# 启动脚本，间接调用mysqld_safe
   mysql.server stop
   ```

2. 启动客户端程序

   通过可执行文件`mysql`与服务器程序交互

   ```bash
   mysql -h主机名 -u用户名 -p密码
   quit/exit/\q	# 均可关闭客户端程序
   ```

## 1.2 连接过程

 <img src="C:\Users\nuaax\AppData\Roaming\Typora\typora-user-images\image-20221022120015751.png" alt="image-20221022120015751" style="zoom:67%;" />

1. 连接管理

   | 通信方式           | 介绍               |
   | ------------------ | ------------------ |
   | TCP/IP             | 启动时默认3306端口 |
   | 命名管道和共享内存 | Windows通信方法    |
   | UNIX套接字         |                    |

   客户端进程连接到服务器进程时，服务器进程会创建一个线程专门处理与该客户端的交互；当该客户端退出时会与服务器断开连接，服务器并不会立即把与客户端交互的线程销毁，而是缓存下来，在与新的客户端连接时，把这个线程分配给新客户端。

2. 解析与优化

   * 查询缓存

     `MySQL`会把刚刚处理过的查询请求和结果缓存起来，下次有同样的请求时，直接在缓存中查找结果

     缓存系统会监测涉及的每张表，只要表结构或数据被修改（`insert, update, delete, alter table, drop table`），该表有关的所有查询缓存均无效且从查询缓存中删除。

   * 语法解析

     将客户端发来的请求文本进行编译，涉及词法解析、语法分析、语义分析等阶段。

   * 查询优化

     `MySQL`优化程序对我们的语句做优化，生成一个执行计划，可以用`explain`语句查看某个语句的执行计划。

3. 存储引擎

   `MySQL`服务器处理请求的过程又可划分为server层和存储引擎层，上述模块均为server层。
   
   存储引擎层为server层提供统一的调用接口，包含几十个底层函数，接收上层传下来的指令，然后对表中的数据进行读取或写入操作，所以又叫“表处理器”。